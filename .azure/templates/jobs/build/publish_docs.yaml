jobs:
  - job: 'publish_docs'
    displayName: 'Publish docs to the website'
    # Set timeout for jobs
    timeoutInMinutes: 60
    # Base system
    pool:
      vmImage: 'Ubuntu-22.04'
    # Pipeline steps
    steps:
      # Unpack the docs
      - task: DownloadPipelineArtifact@2
        inputs:
          source: '${{ parameters.artifactSource }}'
          artifact: Documentation
          path: $(System.DefaultWorkingDirectory)/
          project: '${{ parameters.artifactProject }}'
          pipeline: '${{ parameters.artifactPipeline }}'
          runVersion: '${{ parameters.artifactRunVersion }}'
          runId: '${{ parameters.artifactRunId }}'
      - bash: tar -xvf documentation.tar
        displayName: "Untar the docs"

      # Push docs to the website
      - bash: "make docu_pushtowebsite"
        displayName: "Push docs to the website"
        env:
          BUILD_REASON: $(Build.Reason)
          BRANCH: $(Build.SourceBranch)
          GITHUB_DEPLOY_KEY: $(GITHUB_DEPLOY_KEY)